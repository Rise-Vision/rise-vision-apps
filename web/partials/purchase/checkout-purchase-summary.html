<!-- Step 5 -->
<div id="checkout-purchase-summary" class="purchase-summary">
  <h4 class="u_margin-md-bottom mt-0">Subscription Details</h4>

  <div id="errorBox" class="madero-style alert alert-danger u_margin-md-top" role="alert" ng-show="purchase.estimate.estimateError">
    <div class="row">
      <div class="col-xs-9">
        <p>
          <strong>Tax Estimate Error</strong> {{purchase.estimate.estimateError}}
        </p>
      </div>
      <div class="col-xs-3">
        <a class="btn btn-default btn-block" href="#" ng-click="factory.getEstimate()">
          Retry
        </a>
      </div>
    </div>
  </div>

  <p>
    <b>Purchasing for: {{selectedCompany.name}}</b><br>
    {{selectedCompany.id}}
  </p>

  <div class="border-bottom py-4 mb-4">
    <p class="mb-0">
      <span class="font-weight-bold">{{purchase.plan.displays}} Display License<span ng-show="purchase.plan.displays !== 1">s</span>:</span>
      <span class="pull-right">${{purchase.estimate.subTotal}}</span>
    </p>
    <p class="mb-0">
      <span>${{(purchase.estimate.subTotal / purchase.plan.displays / (purchase.plan.isMonthly ? 1 : 12)) | number:2}} per display license, per month.</span>
      <span class="pull-right">
        <a aria-label="Edit Subscription Details" class="madero-link u_clickable" ng-click="setCurrentStep(-1)" tabindex="1">Edit</a>
      </span>
    </p>
  </div>
  <div ng-hide="purchase.plan.isMonthly || purchase.estimate.couponAmount > 0">
    <p class="mb-4" ng-show="!addCoupon">
      &nbsp;
      <span class="pull-right">
        <a aria-label="Edit Subscription Details" class="madero-link u_clickable" ng-click="addCoupon = true" tabindex="1">Add A Coupon Code</a>
      </span>
    </p>    
    <div class="row" ng-show="addCoupon">
      <div class="col-md-12">
        <div class="form-group">
          <label for="coupon-code" class="control-label">Coupon Code:</label>
          <span class="pull-right">
            <a aria-label="Cancel Coupon Code" class="madero-link u_clickable" ng-click="addCoupon = false" tabindex="1">Cancel</a>
          </span>
          <div class="flex-row">
            <input id="coupon-code" aria-required="false" type="text" class="form-control mr-3" name="couponCode" ng-model="purchase.couponCode">
            <button id="apply-coupon-code" type="button" aria-label="Apply Coupon Code" class="btn btn-default" ng-click="applyCouponCode()">Apply</button>
          </div>
        </div>
      </div>
    </div>
    <p class="mb-0" ng-show="purchase.estimate.couponAmount > 0">
      <span class="font-weight-bold">Promotions and discounts:</span>
      <span class="pull-right">-${{purchase.estimate.couponAmount}}</span>
    </p>
  </div>
  <div ng-show="purchase.estimate.couponAmount > 0">
    <p class="mb-0">
      <span class="font-weight-bold">Promotions and discounts:</span>
      <span class="pull-right">-${{purchase.estimate.couponAmount}}</span>
    </p>
  </div>
  <div class="border-bottom pb-4">
    <p class="mb-0" ng-repeat="tax in purchase.estimate.taxes">
      <span>{{tax.taxName}}:</span>
      <span class="pull-right">${{tax.taxAmount | number:2}}</span>
    </p>
    <p class="mb-0">
      <span class="font-weight-bold">Total tax:</span>
      <span class="pull-right">${{purchase.estimate.totalTax | number:2}}</span>
    </p>
  </div>

  <div class="py-4">
    <p class="mb-0">
      <span class="font-weight-bold">Total cost per {{purchase.plan.isMonthly ? 'month' : 'year'}}:</span>
      <span class="pull-right"><span class="u_margin-right text-subtle">{{purchase.estimate.currency | uppercase}}</span><span class="purchase-total">${{purchase.estimate.total | number:2}}</span></span>
    </p>    
  </div>

  <div class="row">
    <div class="col-xs-12 text-center u_margin-sm-bottom">
      <a id="showTaxExemption" href="#" aria-label="Are you Tax Exempt?" ng-click="showTaxExemptionModal()" ng-show="purchase.estimate.totalTax > 0 && !purchase.taxExemptionSent" translate>Are you Tax Exempt?</a>
      <h5 ng-show="purchase.taxExemptionSent">Tax Exemption Submitted</h5>
    </div>
  </div>

  <div id="errorBox" class="madero-style alert alert-danger u_margin-md-top" role="alert" ng-show="purchase.checkoutError">
    <strong>Payment Error</strong> {{purchase.checkoutError}}
  </div>

</div>
